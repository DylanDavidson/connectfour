// Generated by CoffeeScript 1.10.0
(function() {
  this.Piece = (function() {
    Piece.prototype.START_HEIGHT = 75;

    Piece.prototype.velocity = 1;

    Piece.prototype.height = 75;

    function Piece(game, player) {
      var color;
      if (player == null) {
        player = true;
      }
      this.game = game;
      this.geometry = new THREE.CylinderGeometry(6, 6, 3, 20);
      if (player) {
        color = 0xf1c40f;
      } else {
        color = 0xe74c3c;
      }
      this.material = new THREE.MeshPhongMaterial({
        color: color
      });
      this.object = new Physijs.CylinderMesh(this.geometry, this.material, 10);
      this.object._physijs.collision_flags = 4;
      this.object.receiveShadow = true;
      this.object.castShadow = true;
      game.addToScene(this.object);
    }

    Piece.prototype.setName = function(name) {
      return this.object.name = name;
    };

    Piece.prototype.setColor = function(color) {
      return this.object.material.color.set(color);
    };

    Piece.prototype.setOpacity = function(opacity) {
      this.object.material.transparent = true;
      return this.object.material.opacity = opacity;
    };

    Piece.prototype.setPosition = function(x, y, z) {
      this.object.position.set(x, y, z);
      return this.object.__dirtyPosition = true;
    };

    Piece.prototype.place = function(row, column) {
      var x_val;
      x_val = this.game.board.COLUMNS[column];
      this.setPosition(x_val, -1, this.START_HEIGHT);
      return this.check(row);
    };

    Piece.prototype.stop = function() {
      return this.object.mass = 0;
    };

    Piece.prototype.check = function(row) {
      if (this.object.position.z <= this.game.board.ROWS[row]) {
        this.stop();
        this.object.position.setZ(this.game.board.ROWS[row]);
        this.object.__dirtyPosition = true;
        return this.game.sound.playPieceSound();
      } else {
        return timeout(30, (function(_this) {
          return function() {
            return _this.check(row);
          };
        })(this));
      }
    };

    return Piece;

  })();

}).call(this);
